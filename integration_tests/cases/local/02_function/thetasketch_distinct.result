DROP TABLE IF EXISTS `02_function_thetasketch_distinct_table`;

affected_rows: 0

CREATE TABLE `02_function_thetasketch_distinct_table` (
    `timestamp` timestamp NOT NULL,
    `arch` string TAG,
    `datacenter` string TAG,
    `value` int,
    timestamp KEY (timestamp)) ENGINE=Analytic
WITH(
	 enable_ttl='false'
);

affected_rows: 0

INSERT INTO `02_function_thetasketch_distinct_table`
(`timestamp`, `arch`, `datacenter`, `value`)
VALUES
    (1658304762, 'x86', 'china', 75),
    (1658304763, 'x86', 'china', 15),
    (1658304764, 'x86', 'china', 87),
    (1658304765, 'x86', 'china', 6),
    (1658304766, 'x86', 'china', 112),
    (1658304767, 'x86', 'china', 5),
    (1658304768, 'x86', 'china', 67),
    (1658304769, 'x86', 'china', 41),
    (1658304770, 'x86', 'china', 93),
    (1658304771, 'x86', 'china', 9),
    (1658304772, 'x86', 'china', 82),
    (1658304773, 'x86', 'china', 97),
    (1658304774, 'x86', 'china', 121),
    (1658304775, 'x86', 'china', 97),
    (1658304776, 'x86', 'china', 114),
    (1658304777, 'x86', 'china', 8),
    (1658304778, 'x86', 'china', 9),
    (1658304779, 'x86', 'china', 13),
    (1658304780, 'x86', 'china', 8),
    (1658304781, 'x86', 'china', 146),
    (1658304782, 'x86', 'china', 131),
    (1658304783, 'x86', 'china', 45),
    (1658304784, 'x86', 'china', 57),
    (1658304785, 'x86', 'china', 74),
    (1658304786, 'x86', 'china', 25),
    (1658304787, 'x86', 'china', 67),
    (1658304788, 'x86', 'china', 108),
    (1658304789, 'x86', 'china', 32),
    (1658304790, 'x86', 'china', 67),
    (1658304791, 'x86', 'china', 61),
    (1658304792, 'x86', 'china', 7),
    (1658304793, 'x86', 'china', 107),
    (1658304794, 'x86', 'china', 18),
    (1658304795, 'x86', 'china', 127),
    (1658304796, 'x86', 'china', 88),
    (1658304797, 'x86', 'china', 21),
    (1658304798, 'x86', 'china', 85),
    (1658304799, 'x86', 'china', 117),
    (1658304800, 'x86', 'china', 51),
    (1658304801, 'x86', 'china', 23),
    (1658304802, 'x86', 'china', 74),
    (1658304803, 'x86', 'china', 77),
    (1658304804, 'x86', 'china', 66),
    (1658304805, 'x86', 'china', 84),
    (1658304806, 'x86', 'china', 1),
    (1658304807, 'x86', 'china', 108),
    (1658304808, 'x86', 'china', 50),
    (1658304809, 'x86', 'china', 80),
    (1658304810, 'x86', 'china', 30),
    (1658304811, 'x86', 'china', 36),
    (1658304812, 'x86', 'china', 110),
    (1658304813, 'x86', 'china', 22),
    (1658304814, 'x86', 'china', 126),
    (1658304815, 'x86', 'china', 142),
    (1658304816, 'x86', 'china', 17),
    (1658304817, 'x86', 'china', 38),
    (1658304818, 'x86', 'china', 40),
    (1658304819, 'x86', 'china', 114),
    (1658304820, 'x86', 'china', 18),
    (1658304821, 'x86', 'china', 8),
    (1658304822, 'x86', 'china', 144),
    (1658304823, 'x86', 'china', 61),
    (1658304824, 'x86', 'china', 49),
    (1658304825, 'x86', 'china', 28),
    (1658304826, 'x86', 'china', 80),
    (1658304827, 'x86', 'china', 149),
    (1658304828, 'x86', 'china', 144),
    (1658304829, 'x86', 'china', 74),
    (1658304830, 'x86', 'china', 130),
    (1658304831, 'x86', 'china', 116),
    (1658304832, 'x86', 'china', 72),
    (1658304833, 'x86', 'china', 61),
    (1658304834, 'x86', 'china', 24),
    (1658304835, 'x86', 'china', 47),
    (1658304836, 'x86', 'china', 35),
    (1658304837, 'x86', 'china', 62),
    (1658304838, 'x86', 'china', 148),
    (1658304839, 'x86', 'china', 111),
    (1658304840, 'x86', 'china', 86),
    (1658304841, 'x86', 'china', 139),
    (1658304842, 'x86', 'china', 83),
    (1658304843, 'x86', 'china', 144),
    (1658304844, 'x86', 'china', 87),
    (1658304845, 'x86', 'china', 108),
    (1658304846, 'x86', 'china', 105),
    (1658304847, 'x86', 'china', 20),
    (1658304848, 'x86', 'china', 35),
    (1658304849, 'x86', 'china', 132),
    (1658304850, 'x86', 'china', 80),
    (1658304851, 'x86', 'china', 24),
    (1658304852, 'x86', 'china', 139),
    (1658304853, 'x86', 'china', 43),
    (1658304854, 'x86', 'china', 68),
    (1658304855, 'x86', 'china', 65),
    (1658304856, 'x86', 'china', 83),
    (1658304857, 'x86', 'china', 101),
    (1658304858, 'x86', 'china', 148),
    (1658304859, 'x86', 'china', 112),
    (1658304860, 'x86', 'china', 33),
    (1658304861, 'x86', 'china', 19),
    (1658304862, 'x86', 'china', 6),
    (1658304863, 'x86', 'china', 73),
    (1658304864, 'x86', 'china', 134),
    (1658304865, 'x86', 'china', 61),
    (1658304866, 'x86', 'china', 9),
    (1658304867, 'x86', 'china', 103),
    (1658304868, 'x86', 'china', 55),
    (1658304869, 'x86', 'china', 62),
    (1658304870, 'x86', 'china', 58),
    (1658304871, 'x86', 'china', 85),
    (1658304872, 'x86', 'china', 83),
    (1658304873, 'x86', 'china', 39),
    (1658304874, 'x86', 'china', 48),
    (1658304875, 'x86', 'china', 95),
    (1658304876, 'x86', 'china', 16),
    (1658304877, 'x86', 'china', 144),
    (1658304878, 'x86', 'china', 60),
    (1658304879, 'x86', 'china', 83),
    (1658304880, 'x86', 'china', 140),
    (1658304881, 'x86', 'china', 48),
    (1658304882, 'x86', 'china', 117),
    (1658304883, 'x86', 'china', 146),
    (1658304884, 'x86', 'china', 31),
    (1658304885, 'x86', 'china', 143),
    (1658304886, 'x86', 'china', 102),
    (1658304887, 'x86', 'china', 98),
    (1658304888, 'x86', 'china', 41),
    (1658304889, 'x86', 'china', 50),
    (1658304890, 'x86', 'china', 46),
    (1658304891, 'x86', 'china', 143),
    (1658304892, 'x86', 'china', 82),
    (1658304893, 'x86', 'china', 142),
    (1658304894, 'x86', 'china', 110),
    (1658304895, 'x86', 'china', 113),
    (1658304896, 'x86', 'china', 89),
    (1658304897, 'x86', 'china', 38),
    (1658304898, 'x86', 'china', 92),
    (1658304899, 'x86', 'china', 137),
    (1658304900, 'x86', 'china', 120),
    (1658304901, 'x86', 'china', 74),
    (1658304902, 'x86', 'china', 64),
    (1658304903, 'x86', 'china', 134),
    (1658304904, 'x86', 'china', 121),
    (1658304905, 'x86', 'china', 40),
    (1658304906, 'x86', 'china', 148),
    (1658304907, 'x86', 'china', 37),
    (1658304908, 'x86', 'china', 72),
    (1658304909, 'x86', 'china', 131),
    (1658304910, 'x86', 'china', 142),
    (1658304911, 'x86', 'china', 53),
    (1658304912, 'x86', 'china', 46),
    (1658304913, 'x86', 'china', 83),
    (1658304914, 'x86', 'china', 52),
    (1658304915, 'x86', 'china', 83),
    (1658304916, 'x86', 'china', 150),
    (1658304917, 'x86', 'china', 13),
    (1658304918, 'x86', 'china', 133),
    (1658304919, 'x86', 'china', 69),
    (1658304920, 'x86', 'china', 46),
    (1658304921, 'x86', 'china', 13),
    (1658304922, 'x86', 'china', 4),
    (1658304923, 'x86', 'china', 84),
    (1658304924, 'x86', 'china', 116),
    (1658304925, 'x86', 'china', 54),
    (1658304926, 'x86', 'china', 38),
    (1658304927, 'x86', 'china', 125),
    (1658304928, 'x86', 'china', 28),
    (1658304929, 'x86', 'china', 45),
    (1658304930, 'x86', 'china', 147),
    (1658304931, 'x86', 'china', 36),
    (1658304932, 'x86', 'china', 6),
    (1658304933, 'x86', 'china', 2),
    (1658304934, 'x86', 'china', 16),
    (1658304935, 'x86', 'china', 149),
    (1658304936, 'x86', 'china', 109),
    (1658304937, 'x86', 'china', 22),
    (1658304938, 'x86', 'china', 143),
    (1658304939, 'x86', 'china', 46),
    (1658304940, 'x86', 'china', 139),
    (1658304941, 'x86', 'china', 128),
    (1658304942, 'x86', 'china', 5),
    (1658304943, 'x86', 'china', 9),
    (1658304944, 'x86', 'china', 80),
    (1658304945, 'x86', 'china', 56),
    (1658304946, 'x86', 'china', 94),
    (1658304947, 'x86', 'china', 115),
    (1658304948, 'x86', 'china', 9),
    (1658304949, 'x86', 'china', 111),
    (1658304950, 'x86', 'china', 118),
    (1658304951, 'x86', 'china', 77),
    (1658304952, 'x86', 'china', 43),
    (1658304953, 'x86', 'china', 65),
    (1658304954, 'x86', 'china', 129),
    (1658304955, 'x86', 'china', 118),
    (1658304956, 'x86', 'china', 68),
    (1658304957, 'x86', 'china', 10),
    (1658304958, 'x86', 'china', 11),
    (1658304959, 'x86', 'china', 82),
    (1658304960, 'x86', 'china', 115),
    (1658304961, 'x86', 'china', 86),
    (1658304762, 'arm', 'china', 145),
    (1658304763, 'arm', 'china', 36),
    (1658304764, 'arm', 'china', 11),
    (1658304765, 'arm', 'china', 3),
    (1658304766, 'arm', 'china', 135),
    (1658304767, 'arm', 'china', 117),
    (1658304768, 'arm', 'china', 137),
    (1658304769, 'arm', 'china', 140),
    (1658304770, 'arm', 'china', 135),
    (1658304771, 'arm', 'china', 91),
    (1658304772, 'arm', 'china', 143),
    (1658304773, 'arm', 'china', 25),
    (1658304774, 'arm', 'china', 93),
    (1658304775, 'arm', 'china', 137),
    (1658304776, 'arm', 'china', 10),
    (1658304777, 'arm', 'china', 15),
    (1658304778, 'arm', 'china', 106),
    (1658304779, 'arm', 'china', 144),
    (1658304780, 'arm', 'china', 40),
    (1658304781, 'arm', 'china', 118),
    (1658304782, 'arm', 'china', 5),
    (1658304783, 'arm', 'china', 37),
    (1658304784, 'arm', 'china', 61),
    (1658304785, 'arm', 'china', 103),
    (1658304786, 'arm', 'china', 73),
    (1658304787, 'arm', 'china', 133),
    (1658304788, 'arm', 'china', 147),
    (1658304789, 'arm', 'china', 2),
    (1658304790, 'arm', 'china', 132),
    (1658304791, 'arm', 'china', 52),
    (1658304792, 'arm', 'china', 85),
    (1658304793, 'arm', 'china', 38),
    (1658304794, 'arm', 'china', 137),
    (1658304795, 'arm', 'china', 67),
    (1658304796, 'arm', 'china', 47),
    (1658304797, 'arm', 'china', 46),
    (1658304798, 'arm', 'china', 85),
    (1658304799, 'arm', 'china', 113),
    (1658304800, 'arm', 'china', 7),
    (1658304801, 'arm', 'china', 125),
    (1658304802, 'arm', 'china', 65),
    (1658304803, 'arm', 'china', 89),
    (1658304804, 'arm', 'china', 36),
    (1658304805, 'arm', 'china', 123),
    (1658304806, 'arm', 'china', 40),
    (1658304807, 'arm', 'china', 101),
    (1658304808, 'arm', 'china', 39),
    (1658304809, 'arm', 'china', 0),
    (1658304810, 'arm', 'china', 120),
    (1658304811, 'arm', 'china', 100),
    (1658304812, 'arm', 'china', 127),
    (1658304813, 'arm', 'china', 58),
    (1658304814, 'arm', 'china', 110),
    (1658304815, 'arm', 'china', 107),
    (1658304816, 'arm', 'china', 25),
    (1658304817, 'arm', 'china', 85),
    (1658304818, 'arm', 'china', 61),
    (1658304819, 'arm', 'china', 19),
    (1658304820, 'arm', 'china', 150),
    (1658304821, 'arm', 'china', 30),
    (1658304822, 'arm', 'china', 47),
    (1658304823, 'arm', 'china', 65),
    (1658304824, 'arm', 'china', 70),
    (1658304825, 'arm', 'china', 52),
    (1658304826, 'arm', 'china', 54),
    (1658304827, 'arm', 'china', 145),
    (1658304828, 'arm', 'china', 0),
    (1658304829, 'arm', 'china', 148),
    (1658304830, 'arm', 'china', 76),
    (1658304831, 'arm', 'china', 59),
    (1658304832, 'arm', 'china', 47),
    (1658304833, 'arm', 'china', 12),
    (1658304834, 'arm', 'china', 83),
    (1658304835, 'arm', 'china', 135),
    (1658304836, 'arm', 'china', 37),
    (1658304837, 'arm', 'china', 94),
    (1658304838, 'arm', 'china', 129),
    (1658304839, 'arm', 'china', 105),
    (1658304840, 'arm', 'china', 0),
    (1658304841, 'arm', 'china', 5),
    (1658304842, 'arm', 'china', 84),
    (1658304843, 'arm', 'china', 74),
    (1658304844, 'arm', 'china', 132),
    (1658304845, 'arm', 'china', 138),
    (1658304846, 'arm', 'china', 75),
    (1658304847, 'arm', 'china', 92),
    (1658304848, 'arm', 'china', 55),
    (1658304849, 'arm', 'china', 51),
    (1658304850, 'arm', 'china', 103),
    (1658304851, 'arm', 'china', 20),
    (1658304852, 'arm', 'china', 7),
    (1658304853, 'arm', 'china', 19),
    (1658304854, 'arm', 'china', 97),
    (1658304855, 'arm', 'china', 15),
    (1658304856, 'arm', 'china', 28),
    (1658304857, 'arm', 'china', 60),
    (1658304858, 'arm', 'china', 56),
    (1658304859, 'arm', 'china', 23),
    (1658304860, 'arm', 'china', 146),
    (1658304861, 'arm', 'china', 78),
    (1658304862, 'arm', 'china', 106),
    (1658304863, 'arm', 'china', 128),
    (1658304864, 'arm', 'china', 119),
    (1658304865, 'arm', 'china', 84),
    (1658304866, 'arm', 'china', 7),
    (1658304867, 'arm', 'china', 147),
    (1658304868, 'arm', 'china', 124),
    (1658304869, 'arm', 'china', 130),
    (1658304870, 'arm', 'china', 20),
    (1658304871, 'arm', 'china', 44),
    (1658304872, 'arm', 'china', 82),
    (1658304873, 'arm', 'china', 148),
    (1658304874, 'arm', 'china', 84),
    (1658304875, 'arm', 'china', 125),
    (1658304876, 'arm', 'china', 130),
    (1658304877, 'arm', 'china', 136),
    (1658304878, 'arm', 'china', 6),
    (1658304879, 'arm', 'china', 41),
    (1658304880, 'arm', 'china', 29),
    (1658304881, 'arm', 'china', 122),
    (1658304882, 'arm', 'china', 3),
    (1658304883, 'arm', 'china', 115),
    (1658304884, 'arm', 'china', 101),
    (1658304885, 'arm', 'china', 132),
    (1658304886, 'arm', 'china', 7),
    (1658304887, 'arm', 'china', 81),
    (1658304888, 'arm', 'china', 57),
    (1658304889, 'arm', 'china', 115),
    (1658304890, 'arm', 'china', 132),
    (1658304891, 'arm', 'china', 100),
    (1658304892, 'arm', 'china', 20),
    (1658304893, 'arm', 'china', 147),
    (1658304894, 'arm', 'china', 42),
    (1658304895, 'arm', 'china', 95),
    (1658304896, 'arm', 'china', 21),
    (1658304897, 'arm', 'china', 75),
    (1658304898, 'arm', 'china', 86),
    (1658304899, 'arm', 'china', 63),
    (1658304900, 'arm', 'china', 45),
    (1658304901, 'arm', 'china', 6),
    (1658304902, 'arm', 'china', 37),
    (1658304903, 'arm', 'china', 111),
    (1658304904, 'arm', 'china', 106),
    (1658304905, 'arm', 'china', 86),
    (1658304906, 'arm', 'china', 76),
    (1658304907, 'arm', 'china', 52),
    (1658304908, 'arm', 'china', 38),
    (1658304909, 'arm', 'china', 78),
    (1658304910, 'arm', 'china', 111),
    (1658304911, 'arm', 'china', 121),
    (1658304912, 'arm', 'china', 67),
    (1658304913, 'arm', 'china', 134),
    (1658304914, 'arm', 'china', 105),
    (1658304915, 'arm', 'china', 105),
    (1658304916, 'arm', 'china', 70),
    (1658304917, 'arm', 'china', 116),
    (1658304918, 'arm', 'china', 81),
    (1658304919, 'arm', 'china', 102),
    (1658304920, 'arm', 'china', 87),
    (1658304921, 'arm', 'china', 85),
    (1658304922, 'arm', 'china', 87),
    (1658304923, 'arm', 'china', 90),
    (1658304924, 'arm', 'china', 33),
    (1658304925, 'arm', 'china', 14),
    (1658304926, 'arm', 'china', 54),
    (1658304927, 'arm', 'china', 61),
    (1658304928, 'arm', 'china', 64),
    (1658304929, 'arm', 'china', 74),
    (1658304930, 'arm', 'china', 141),
    (1658304931, 'arm', 'china', 9),
    (1658304932, 'arm', 'china', 40),
    (1658304933, 'arm', 'china', 139),
    (1658304934, 'arm', 'china', 55),
    (1658304935, 'arm', 'china', 92),
    (1658304936, 'arm', 'china', 99),
    (1658304937, 'arm', 'china', 70),
    (1658304938, 'arm', 'china', 79),
    (1658304939, 'arm', 'china', 10),
    (1658304940, 'arm', 'china', 89),
    (1658304941, 'arm', 'china', 90),
    (1658304942, 'arm', 'china', 71),
    (1658304943, 'arm', 'china', 0),
    (1658304944, 'arm', 'china', 101),
    (1658304945, 'arm', 'china', 83),
    (1658304946, 'arm', 'china', 92),
    (1658304947, 'arm', 'china', 148),
    (1658304948, 'arm', 'china', 22),
    (1658304949, 'arm', 'china', 79),
    (1658304950, 'arm', 'china', 120),
    (1658304951, 'arm', 'china', 59),
    (1658304952, 'arm', 'china', 136),
    (1658304953, 'arm', 'china', 47),
    (1658304954, 'arm', 'china', 122),
    (1658304955, 'arm', 'china', 60),
    (1658304956, 'arm', 'china', 108),
    (1658304957, 'arm', 'china', 96),
    (1658304958, 'arm', 'china', 74),
    (1658304959, 'arm', 'china', 50),
    (1658304960, 'arm', 'china', 46),
    (1658304961, 'arm', 'china', 82);

affected_rows: 400

SELECT thetasketch_distinct(`value`) FROM `02_function_thetasketch_distinct_table`;

thetasketch_distinct(02_function_thetasketch_distinct_table.value),
UInt64(147),


SELECT
    `arch`,
    thetasketch_distinct(`value`)
FROM
    `02_function_thetasketch_distinct_table`
WHERE
    `timestamp` BETWEEN 1658304766 AND 1658304961
GROUP BY
    `arch`
ORDER BY
    `arch` DESC;

arch,thetasketch_distinct(02_function_thetasketch_distinct_table.value),
String("x86"),UInt64(115),
String("arm"),UInt64(114),


DROP TABLE `02_function_thetasketch_distinct_table`;

affected_rows: 0

